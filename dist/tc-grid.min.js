"use strict";!function(){function t(t,n,i,o){return{restrict:"E",scope:!0,priority:1,compile:function(t,n){var o=t.find("tc-column");angular.forEach(o,function(t,n){var i=t.getAttribute("tc-class");t.setAttribute("data-identifier",Math.random()),t.setAttribute("tc-col-index",n+1),t.className+=" "+(i||"tc-style_td")});var e=i.get("tcGrid.html");e=e.replace(/%GRIDCLASS%/g,n.tcGridClass||"tc-grid"),e=e.replace(/%ROWCLASS%/g,n.tcRowClass?"":"tc-style_tr"),e=e.replace(/%ROWEXPRESSION%/g,n.tcRowClass||""),e=e.replace(/%ROWCLICK%/g,n.tcRowClick?'ng-click="'+n.tcRowClick+'"':""),e=e.replace(/%ROWLINK%/g,n.tcRowLink?' ng-href="'+n.tcRowLink+'"':""),e=e.replace(/%FILTER%/g,n.tcGridFilter?" | filter: "+n.tcGridFilter:"");var a=angular.element(e),r=a[0].querySelector(".tc-display_tbody .tc-display_tr");return n.rowTemplate=angular.element(r),n.rowTemplate.append(o),r=null,t.html(""),t.append(a),a=null,{pre:function(){},post:function(){}}},controller:["$scope","$element","$attrs",function(i,e,a){function r(){T.options=t(a.tcOptions)(i.$parent),T.data=t(a.tcData)(i.$parent),c(),v(),C(),T.options&&(T.options.onLoad&&"function"==typeof T.options.onLoad?T.options.onLoad():T.options.sorting.onSortChange?w():T.options.paging.onPageChange&&O())}function s(){T.options.paging.currentPage=1,T.options.sorting.sort=[],$(),O(),w()}function c(){for(var n in a.columns)a.columns[n].visible?(m(n,a.columns[n].visible),T.columns[n]={field:a.columns[n].field,visible:t(a.columns[n].visible)(i.$parent)}):T.columns[n]={field:a.columns[n].field,visible:!0}}function l(t,n){if(!p(n)){var i,o,e;n.tcField=n.tcField||"",n.tcName=n.tcName||n.tcField||"";var r=T.headerTemplates.length;n.tcField?(i=" ng-click=\"tcGrid.sort('"+n.tcField+"')\"",o=' id="'+a.tcOptions+"_"+n.tcField.replace(/\./g,"")+'"'):(i="",o=""),e="ng-class=\"{'tc-hide-col': !tcGrid.columns['"+r+"'].visible}\"";var s='<div class="tc-display_th tc-style_th" tc-col-index="'+(r+1)+'"'+o+i+e+">"+n.tcName+'<span class="tc-display_sort tc-style_sort"></span></div>',c=angular.element(s);T.headerTemplates.push(c),T.columnTemplates.push(t.clone()),t=null,c=null,I(n),g()}}function p(t){for(var n=0;n<T.columns.length;n++)if(T.columns[n].identifier===t.identifier)return!0;return!1}function g(t){if(!t)for(var t=[],n=0;n<T.columns.length;n++)t.push(n+1);if(T.columns.length){var i=f();u(i,t),i=null}}function u(t,o){var e=angular.element(t.thead),a=angular.element(e.find("div")[0]);a.html("");for(var r in o){var s=d(T.headerTemplates,o[r]);a.append(s.clone()),s=null}n(e)(i),a=null,e=null,y()}function d(t,n){for(var i in t){var o=t[i].attr("tc-col-index"),e=t[i].attr("tc-name"),a=t[i].attr("tc-field");if(o==n||e==n||a==n)return t[i]}}function f(){var t,n,i,o=document.getElementsByClassName("tc-display_table")[0],e=Array.prototype.slice.call(o.children);for(var a in e)i=e[a],i.className&&i.className.indexOf("tc-display_thead")>-1?t=i:i.className&&i.className.indexOf("tc-display_tbody")>-1&&(n=i,n.parent=i.parentNode);return o.tbody=n,o.thead=t,n=null,t=null,o}function m(t,n){i.$parent.$watch(n,function(n,i){n!=i&&(T.columns[t].visible=n)})}function v(){T.options&&(T.options.reset=s,T.options.prev=P,T.options.next=S,T.options.first=b,T.options.last=_,T.options.sort=R,T.options.paging?h():T.options.paging={},T.options.sorting?y():T.options.sorting={})}function C(){function t(){return E?void(T.options&&T.options.paging&&G()):void(E=!0)}a.tcOptions&&i.$parent.$watch(a.tcOptions,function(n,i){if(T.options=n,n==i&&n.columnDisplay)g(T.options.columnDisplay);else if(n!=i||n.columnDisplay)n.columnDisplay!=i.columnDisplay&&g(T.options.columnDisplay);else{for(var o=[],e=0;e<T.columns.length;e++)o.push(e+1);g(o)}t()},!0),i.$parent.$watchCollection(a.tcData,function(t){T.data=t})}function h(){(!T.options.paging.pageSize||T.options.paging.pageSize<1)&&(T.options.paging.pageSizeOptions?T.options.paging.pageSize=T.options.paging.pageSizeOptions[0]:T.options.paging.pageSize=20),(!T.options.paging.totalItemCount||T.options.paging.totalItemCount<0)&&(T.options.paging.totalItemCount=0),(!T.options.paging.currentPage||T.options.paging.currentPage<1)&&(T.options.paging.currentPage=1),G(),a.tcHideFooter||(T.showFooter=!0)}function y(){T.options.sorting.sort&&angular.forEach(T.options.sorting.sort,function(t){var n=t.split(" ")[0],i=t.split(" ")[1]||"asc",o=z(n);o&&(o.addClass(i.toLowerCase()),o=null)})}function G(){T.pageCount=T.options.paging.totalItemCount>0?Math.ceil(T.options.paging.totalItemCount/T.options.paging.pageSize):0,T.pageCount<1&&(T.pageCount=1),T.options.paging.pageCount=T.pageCount}function b(){T.options.paging.currentPage=1,O()}function P(){T.options.paging.currentPage-=1,T.options.paging.currentPage<1&&(T.options.paging.currentPage=1),O()}function S(){T.options.paging.currentPage+=1,T.options.paging.currentPage>T.pageCount&&(T.options.paging.currentPage=T.pageCount),O()}function _(){T.options.paging.currentPage=T.pageCount,O()}function O(){T.options.paging.onPageChange&&T.options.paging.onPageChange(T.options.paging.currentPage,T.options.paging.pageSize,T.options.sorting.sort)}function w(){T.options.sorting.onSortChange&&(T.options.paging?(T.options.paging.currentPage=1,T.options.sorting.onSortChange(T.options.paging.currentPage,T.options.paging.pageSize,T.options.sorting.sort)):T.options.sorting.onSortChange(null,null,T.options.sorting.sort))}function R(t){if(0!==Object.getOwnPropertyNames(T.columns).length){var n=z(t);if(n){var i="asc";n.hasClass("asc")&&(i="desc"),$(),n.addClass(i),T.options.sorting.sort=[t+" "+i],w(),n=null}}}function $(){angular.forEach(Object.keys(T.columns),function(t){if(T.columns[t].field){var n=z(T.columns[t].field);n&&(n.removeClass("desc"),n.removeClass("asc"),n=null)}})}function z(t){if(t){var n=a.tcOptions+"_"+t.replace(/\./g,""),i=document.getElementById(n);if(i){var o=i.childNodes;for(var e in o)if(o[e].className&&o[e].className.indexOf("tc-display_sort")>-1)return angular.element(o[e])}return null}}function I(t){T.columns.push({field:t.tcField,identifier:t.identifier,visible:!0})}function N(){G(),T.options.paging.currentPage>T.pageCount?T.options.paging.currentPage=T.pageCount:T.options.paging.currentPage<0&&(T.options.paging.currentPage=0),O()}var L,F,E=!1,T=this;T.pageCount=1,T.showFooter=!1,T.columns=[],T.columnTemplates=[],T.headerTemplates=[],T.rowTemplate=a.rowTemplate,a.rowTemplate=null,T.addColumn=I,T.prev=P,T.next=S,T.first=b,T.last=_,T.sort=R,T.updatePageSize=N,T.orderColumns=g,T.registerColumn=l,r(),i.$on("$destroy",function(){L&&o.cancel(L),F&&o.cancel(F)})}],controllerAs:"tcGrid"}}function n(){return{restrict:"E",require:"^?tcGrid",replace:!0,transclude:!0,template:"<div class='tc-display_td' ng-transclude></div>",compile:function(t,n){return{pre:function(t,n,i,o){o&&o.registerColumn(n,i)}}}}}angular.module("tc-grid",[]).directive("tcGrid",t).directive("tcColumn",n),t.$inject=["$parse","$compile","$templateCache","$timeout"]}(),angular.module("tc-grid").run(["$templateCache",function(t){t.put("tcGrid.html",'<div class="tcGrid__scope">\r\n    <div class="%GRIDCLASS%">\r\n        <div class="tc-display_table tc-style_table">\r\n            <div class="tc-display_thead tc-style_thead">\r\n                <div class="tc-display_tr tc-style_tr"></div>\r\n            </div>\r\n            <div class="tc-display_tbody tc-style_tbody">\r\n                <a class="tc-display_tr %ROWCLASS%" ng-class="%ROWEXPRESSION%" id="tc-row-container" ng-repeat="row in tcGrid.data %FILTER%" %ROWCLICK% %ROWLINK%></a>\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <div class="tc-display_pager tc-style_pager" ng-show="tcGrid.showFooter && tcGrid.pageCount > 1">\r\n            <div class="tc-display_item-total">\r\n                {{(tcGrid.options.paging.currentPage - 1) * tcGrid.options.paging.pageSize + 1}}\r\n                -\r\n                {{tcGrid.options.paging.currentPage === tcGrid.pageCount ? tcGrid.options.paging.totalItemCount : tcGrid.options.paging.currentPage * tcGrid.options.paging.pageSize}}\r\n                of\r\n                {{tcGrid.options.paging.totalItemCount}}\r\n            </div>\r\n            <div class="tc-display_page-nav">\r\n                <span class="tc-style_page-display">{{tcGrid.options.paging.currentPage}} / {{tcGrid.pageCount}}</span>\r\n                <select class="tc-select" ng-if="tcGrid.options.paging.pageSizeOptions.length" ng-options="pageSize for pageSize in tcGrid.options.paging.pageSizeOptions" ng-model="tcGrid.options.paging.pageSize" ng-change="tcGrid.updatePageSize()"></select>\r\n                <button class="tc-button" ng-click="tcGrid.first()" ng-disabled="tcGrid.options.paging.currentPage === 1"><strong>|</strong>&#9668;</button>\r\n                <button class="tc-button" ng-click="tcGrid.prev()" ng-disabled="tcGrid.options.paging.currentPage === 1">&#9668;</button>\r\n                <button class="tc-button" ng-click="tcGrid.next()" ng-disabled="tcGrid.options.paging.currentPage === tcGrid.pageCount">&#9658;</button>\r\n                <button class="tc-button" ng-click="tcGrid.last()" ng-disabled="tcGrid.options.paging.currentPage === tcGrid.pageCount">&#9658;<strong>|</strong></button>\r\n            </div>\r\n            <div class="clearfix"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n')}]);