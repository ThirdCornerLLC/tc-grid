"use strict";!function(){function t(t,n,o,i){return{restrict:"E",scope:!0,compile:function(t,n){var i=t.find("tc-column"),e="";n.columns={},n.colTemplates=[],n.headerTemplates=[],angular.forEach(i,function(t,o){var i=angular.element(t),a=i.attr("tc-field"),r=i.attr("tc-name")||a||"",s=(i.attr("tc-sort"),i.attr("tc-ignore-click")),c=i.attr("tc-class"),p="",l="",g="";a&&(p=" ng-click=\"tcGrid.sort('"+a+"')\"",l=' id="'+n.tcOptions+"_"+a.replace(/\./g,"")+'"',""===i.html()&&i.html("{{row."+a+"}}")),n.columns[o]={field:a,visible:i.attr("tc-visible")},s&&i.attr("ng-click","$event.stopPropagation();"),i.addClass(c||"tc-style_td"),i.attr("tc-col-index",o+1),i.attr("tc-visible")&&(i.attr("ng-class","{'tc-hide-col': !tcGrid.columns['"+o+"'].visible}"),g="ng-class=\"{'tc-hide-col': !tcGrid.columns['"+o+"'].visible}\"");var d='<div class="tc-display_th tc-style_th" tc-col-index="'+(o+1)+'"'+l+p+g+">"+r+'<span class="tc-display_sort tc-style_sort"></span></div>';if(e+=d,r){var u='<div class="tc-mobile-header">'+r+"</div>";i.prepend(u)}n.headerTemplates.push(angular.element(d)),n.colTemplates.push(i.clone())});var a=o.get("tcGrid.html");a=a.replace(/%OPTIONS%/g,n.tcOptions),a=a.replace(/%HEADER%/g,e),a=a.replace(/%GRIDCLASS%/g,n.tcGridClass||"tc-grid"),a=a.replace(/%ROWCLICK%/g,n.tcRowClick?'ng-click="'+n.tcRowClick+'"':""),a=a.replace(/%ROWLINK%/g,n.tcRowLink?' ng-href="'+n.tcRowLink+'"':""),a=a.replace(/%FILTER%/g,n.tcGridFilter?" | filter: "+n.tcGridFilter:""),a=a.replace(/%ROWCLASS%/g,n.tcRowClass?"":"tc-style_tr"),a=a.replace(/%ROWEXPRESSION%/g,n.tcRowClass||""),a=a.replace(/%CHILDREN%/g,i.parent().html());var r,s=angular.element(a),c=s.find("a");for(var p in c)if("tc-row-container"==c[p].id){r=c[p];break}return n.rowTemplate=angular.element(r),n.rowTemplate.html(""),t.html(""),t.append(s),{pre:function(){},post:function(){}}},controller:["$scope","$element","$attrs",function(o,e,a){function r(){T.options=t(a.tcOptions)(o.$parent),T.data=t(a.tcData)(o.$parent),c(),f(),v(),T.options&&(T.options.onLoad&&"function"==typeof T.options.onLoad?T.options.onLoad():T.options.sorting.onSortChange?O():T.options.paging.onPageChange&&_())}function s(){T.options.paging.currentPage=1,T.options.sorting.sort=[],R(),_(),O()}function c(){for(var n in a.columns)a.columns[n].visible?(m(n,a.columns[n].visible),T.columns[n]={field:a.columns[n].field,visible:t(a.columns[n].visible)(o.$parent)}):T.columns[n]={field:a.columns[n].field,visible:!0}}function p(t){var n=u();g(n,t),l(n,t)}function l(t,e){var a=angular.element('<div class="tc-display_tbody tc-style_tbody"></div>'),r=angular.element(T.rowTemplate);z=i(function(){if(t.tbody&&t.tbody.parentNode){t.tbody.parentNode.removeChild(t.tbody),r.html("");for(var i in e){var s=d(T.columnTemplates,e[i]);s.removeAttr("ng-transclude"),r.append(s.clone())}a.append(r),n(a)(o),t=angular.element(t),t.append(a),o.$apply()}})}function g(t,e){var a=angular.element(t.thead),r=angular.element(a.find("div")[0]);N=i(function(){r.html("");for(var t in e){var i=d(T.headerTemplates,e[t]);r.append(i.clone())}n(a)(o),h()})}function d(t,n){for(var o in t){var i=t[o].attr("tc-col-index"),e=t[o].attr("tc-name"),a=t[o].attr("tc-field");if(i==n||e==n||a==n)return t[o]}}function u(){var t,n,o,i=document.getElementsByClassName("tc-display_table")[0],e=Array.prototype.slice.call(i.children);for(var a in e)o=e[a],o.className&&o.className.indexOf("tc-display_thead")>-1?t=o:o.className&&o.className.indexOf("tc-display_tbody")>-1&&(n=o,n.parent=o.parentNode);return i.tbody=n,i.thead=t,i}function m(t,n){o.$parent.$watch(n,function(n,o){n!=o&&(T.columns[t].visible=n)})}function f(){T.options&&(T.options.reset=s,T.options.prev=G,T.options.next=P,T.options.first=b,T.options.last=S,T.options.sort=w,T.options.paging?C():T.options.paging={},T.options.sorting?h():T.options.sorting={})}function v(){function t(){return L?void(T.options&&T.options.paging&&y()):void(L=!0)}a.tcOptions&&o.$parent.$watch(a.tcOptions,function(n,o){if(T.options=n,n==o&&n.columnDisplay)p(T.options.columnDisplay);else if(n!=o||n.columnDisplay)n.columnDisplay!=o.columnDisplay&&p(T.options.columnDisplay);else{for(var i=[],e=0;e<T.columns.length;e++)i.push(e+1);p(i)}t()},!0),o.$parent.$watchCollection(a.tcData,function(t){T.data=t})}function C(){(!T.options.paging.pageSize||T.options.paging.pageSize<1)&&(T.options.paging.pageSizeOptions?T.options.paging.pageSize=T.options.paging.pageSizeOptions[0]:T.options.paging.pageSize=20),(!T.options.paging.totalItemCount||T.options.paging.totalItemCount<0)&&(T.options.paging.totalItemCount=0),(!T.options.paging.currentPage||T.options.paging.currentPage<1)&&(T.options.paging.currentPage=1),y(),a.tcHideFooter||(T.showFooter=!0)}function h(){T.options.sorting.sort&&angular.forEach(T.options.sorting.sort,function(t){var n=t.split(" ")[0],o=t.split(" ")[1]||"asc",i=$(n);i&&i.addClass(o.toLowerCase())})}function y(){T.pageCount=T.options.paging.totalItemCount>0?Math.ceil(T.options.paging.totalItemCount/T.options.paging.pageSize):0,T.pageCount<1&&(T.pageCount=1),T.options.paging.pageCount=T.pageCount}function b(){T.options.paging.currentPage=1,_()}function G(){T.options.paging.currentPage-=1,T.options.paging.currentPage<1&&(T.options.paging.currentPage=1),_()}function P(){T.options.paging.currentPage+=1,T.options.paging.currentPage>T.pageCount&&(T.options.paging.currentPage=T.pageCount),_()}function S(){T.options.paging.currentPage=T.pageCount,_()}function _(){T.options.paging.onPageChange&&T.options.paging.onPageChange(T.options.paging.currentPage,T.options.paging.pageSize,T.options.sorting.sort)}function O(){T.options.sorting.onSortChange&&(T.options.paging?(T.options.paging.currentPage=1,T.options.sorting.onSortChange(T.options.paging.currentPage,T.options.paging.pageSize,T.options.sorting.sort)):T.options.sorting.onSortChange(null,null,T.options.sorting.sort))}function w(t){if(0!==Object.getOwnPropertyNames(T.columns).length){var n=$(t);if(n){var o="asc";n.hasClass("asc")&&(o="desc"),R(),n.addClass(o),T.options.sorting.sort=[t+" "+o],O()}}}function R(){angular.forEach(Object.keys(T.columns),function(t){if(T.columns[t].field){var n=$(T.columns[t].field);n&&(n.removeClass("desc"),n.removeClass("asc"))}})}function $(t){if(t){var n=a.tcOptions+"_"+t.replace(/\./g,""),o=document.getElementById(n);if(o){var i=o.childNodes;for(var e in i)if(i[e].className&&i[e].className.indexOf("tc-display_sort")>-1)return angular.element(i[e])}return null}}function I(t){-1==T.columns.indexOf(t)&&T.columns.push(t)}function E(){y(),T.options.paging.currentPage>T.pageCount?T.options.paging.currentPage=T.pageCount:T.options.paging.currentPage<0&&(T.options.paging.currentPage=0),_()}var N,z,L=!1,T=this;T.pageCount=1,T.showFooter=!1,T.columns=[],T.columnTemplates=a.colTemplates,T.headerTemplates=a.headerTemplates,T.rowTemplate=a.rowTemplate,T.addColumn=I,T.prev=G,T.next=P,T.first=b,T.last=S,T.sort=w,T.updatePageSize=E,T.orderColumns=p,r(),o.$on("$destroy",function(){N&&i.cancel(N),z&&i.cancel(z)})}],controllerAs:"tcGrid"}}function n(){return{restrict:"E",require:"^tcGrid",replace:!0,transclude:!0,template:"<div class='tc-display_td' ng-transclude></div>"}}angular.module("tc-grid",[]).directive("tcGrid",t).directive("tcColumn",n),t.$inject=["$parse","$compile","$templateCache","$timeout"]}(),angular.module("tc-grid").run(["$templateCache",function(t){t.put("tcGrid.html",'<div class="tcGrid__scope">\r\n    <div class="%GRIDCLASS%">\r\n        <div class="tc-display_table tc-style_table">\r\n            <div class="tc-display_thead tc-style_thead">\r\n                <div class="tc-display_tr tc-style_tr">\r\n                    %HEADER%\r\n                </div>\r\n            </div>\r\n            <div class="tc-display_tbody tc-style_tbody">\r\n                <a class="tc-display_tr %ROWCLASS%" ng-class="%ROWEXPRESSION%" id="tc-row-container" ng-repeat="row in tcGrid.data %FILTER%" %ROWCLICK% %ROWLINK%>\r\n                    %CHILDREN%\r\n                </a>\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <div class="tc-display_pager tc-style_pager" ng-show="tcGrid.showFooter && tcGrid.pageCount > 1">\r\n            <div class="tc-display_item-total">\r\n                {{(tcGrid.options.paging.currentPage - 1) * tcGrid.options.paging.pageSize + 1}}\r\n                -\r\n                {{tcGrid.options.paging.currentPage === tcGrid.pageCount ? tcGrid.options.paging.totalItemCount : tcGrid.options.paging.currentPage * tcGrid.options.paging.pageSize}}\r\n                of\r\n                {{tcGrid.options.paging.totalItemCount}}\r\n            </div>\r\n            <div class="tc-display_page-nav">\r\n                <span class="tc-style_page-display">{{tcGrid.options.paging.currentPage}} / {{tcGrid.pageCount}}</span>\r\n                <select class="tc-select" ng-if="tcGrid.options.paging.pageSizeOptions.length" ng-options="pageSize for pageSize in tcGrid.options.paging.pageSizeOptions" ng-model="tcGrid.options.paging.pageSize" ng-change="tcGrid.updatePageSize()"></select>\r\n                <button class="tc-button" ng-click="tcGrid.first()" ng-disabled="tcGrid.options.paging.currentPage === 1"><strong>|</strong>&#9668;</button>\r\n                <button class="tc-button" ng-click="tcGrid.prev()" ng-disabled="tcGrid.options.paging.currentPage === 1">&#9668;</button>\r\n                <button class="tc-button" ng-click="tcGrid.next()" ng-disabled="tcGrid.options.paging.currentPage === tcGrid.pageCount">&#9658;</button>\r\n                <button class="tc-button" ng-click="tcGrid.last()" ng-disabled="tcGrid.options.paging.currentPage === tcGrid.pageCount">&#9658;<strong>|</strong></button>\r\n            </div>\r\n            <div class="clearfix"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n')}]);