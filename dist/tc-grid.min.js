"use strict";!function(){function t(t,n,i,o){return{restrict:"E",scope:!0,compile:function(t,n){var o=t.find("tc-column"),e="";n.columns={},n.colTemplates=[],n.headerTemplates=[],angular.forEach(o,function(t,i){var o=angular.element(t),a=o.attr("tc-field"),r=o.attr("tc-name")||a||"",s=(o.attr("tc-sort"),o.attr("tc-ignore-click")),c=o.attr("tc-class"),l="",p="",g="";a&&(l=" ng-click=\"tcGrid.sort('"+a+"')\"",p=' id="'+n.tcOptions+"_"+a.replace(/\./g,"")+'"',""===o.html()&&o.html("{{row."+a+"}}")),n.columns[i]={field:a,visible:o.attr("tc-visible")},s&&o.attr("ng-click","$event.stopPropagation();"),o.addClass(c||"tc-style_td"),o.attr("tc-col-index",i+1),o.attr("tc-visible")&&(o.attr("ng-class","{'tc-hide-col': !tcGrid.columns['"+i+"'].visible}"),g="ng-class=\"{'tc-hide-col': !tcGrid.columns['"+i+"'].visible}\"");var d='<div class="tc-display_th tc-style_th tc-display_sort tc-style_sort" tc-col-index="'+(i+1)+'"'+p+l+g+">"+r+"</div>";if(e+=d,r){var u='<div class="tc-mobile-header">'+r+"</div>";o.prepend(u)}n.headerTemplates.push(angular.element(d)),n.colTemplates.push(o)});var a=i.get("tcGrid.html");a=a.replace(/%OPTIONS%/g,n.tcOptions),a=a.replace(/%HEADER%/g,e),a=a.replace(/%GRIDCLASS%/g,n.tcGridClass||"tc-grid"),a=a.replace(/%ROWCLICK%/g,n.tcRowClick?'ng-click="'+n.tcRowClick+'"':""),a=a.replace(/%FILTER%/g,n.tcGridFilter?" | filter: "+n.tcGridFilter:""),a=a.replace(/%ROWCLASS%/g,n.tcRowClass?"":"tc-style_tr"),a=a.replace(/%ROWEXPRESSION%/g,n.tcRowClass||""),a=a.replace(/%CHILDREN%/g,o.parent().html());var r,s=angular.element(a),c=s.find("div");for(var l in c)if("tc-row-container"==c[l].id){r=c[l];break}return n.rowTemplate=angular.element(r),n.rowTemplate.html(""),t.html(""),t.append(s),{pre:function(){},post:function(){}}},controller:["$scope","$element","$attrs",function(i,e,a){function r(){L.options=t(a.tcOptions)(i.$parent),L.data=t(a.tcData)(i.$parent),c(),f(),v(),L.options&&(L.options.sorting.onSortChange?O():L.options.paging.onPageChange&&_())}function s(){L.options.paging.currentPage=1,L.options.sorting.sort=[],$(),_(),O()}function c(){for(var n in a.columns)a.columns[n].visible?(m(n,a.columns[n].visible),L.columns[n]={field:a.columns[n].field,visible:t(a.columns[n].visible)(i.$parent)}):L.columns[n]={field:a.columns[n].field,visible:!0}}function l(){var t=u();g(t),p(t)}function p(t){var e=angular.element('<div class="tc-display_tbody tc-style_tbody"></div>'),a=angular.element(L.rowTemplate);D=o(function(){a.html(""),t.tbody.remove();for(var o in L.options.columnDisplay){var r=d(L.columnTemplates,L.options.columnDisplay[o]);r.removeAttr("ng-transclude"),a.append(r.clone())}e.append(a),n(e)(i),t=angular.element(t),t.append(e)})}function g(t){var e=angular.element(t.thead),a=angular.element(e.find("div")[0]);z=o(function(){a.html("");for(var t in L.options.columnDisplay){var o=d(L.headerTemplates,L.options.columnDisplay[t]);a.append(o)}n(e)(i),C()})}function d(t,n){for(var i in t){var o=t[i].attr("tc-col-index"),e=t[i].attr("tc-name"),a=t[i].attr("tc-field");if(o==n||e==n||a==n)return t[i]}}function u(){var t,n,i,o=document.getElementsByClassName("tc-display_table")[0];for(var e in o.children)i=o.children[e],i.className&&i.className.indexOf("tc-display_thead")>-1?t=i:i.className&&i.className.indexOf("tc-display_tbody")>-1&&(n=i);return o.tbody=n,o.thead=t,o}function m(t,n){i.$parent.$watch(n,function(n,i){n!=i&&(L.columns[t].visible=n)})}function f(){L.options&&(L.options.reset=s,L.options.paging?h():L.options.paging={},L.options.sorting?C():L.options.sorting={})}function v(){function t(){return k?void(L.options&&L.options.paging&&y()):void(k=!0)}a.tcOptions&&i.$parent.$watch(a.tcOptions,function(n,i){L.options=n,n.columnDisplay!=i.columnDisplay&&l(),t()},!0),i.$parent.$watchCollection(a.tcData,function(t){L.data=t})}function h(){(!L.options.paging.pageSize||L.options.paging.pageSize<1)&&(L.options.paging.pageSize=L.options.paging.pageSizeOptions?L.options.paging.pageSizeOptions[0]:20),(!L.options.paging.totalItemCount||L.options.paging.totalItemCount<0)&&(L.options.paging.totalItemCount=0),(!L.options.paging.currentPage||L.options.paging.currentPage<1)&&(L.options.paging.currentPage=1),y(),a.tcHideFooter||(L.showFooter=!0)}function C(){L.options.sorting.sort&&angular.forEach(L.options.sorting.sort,function(t){var n=t.split(" ")[0],i=t.split(" ")[1]||"asc",o=R(n);o.addClass(i.toLowerCase())})}function y(){L.pageCount=L.options.paging.totalItemCount>0?Math.ceil(L.options.paging.totalItemCount/L.options.paging.pageSize):0,L.pageCount<1&&(L.pageCount=1)}function b(){L.options.paging.currentPage=1,_()}function G(){L.options.paging.currentPage-=1,L.options.paging.currentPage<1&&(L.options.paging.currentPage=1),_()}function S(){L.options.paging.currentPage+=1,L.options.paging.currentPage>L.pageCount&&(L.options.paging.currentPage=L.pageCount),_()}function P(){L.options.paging.currentPage=L.pageCount,_()}function _(){L.options.paging.onPageChange&&L.options.paging.onPageChange(L.options.paging.currentPage,L.options.paging.pageSize,L.options.sorting.sort)}function O(){L.options.sorting.onSortChange&&(L.options.paging?(L.options.paging.currentPage=1,L.options.sorting.onSortChange(L.options.paging.currentPage,L.options.paging.pageSize,L.options.sorting.sort)):L.options.sorting.onSortChange(null,null,L.options.sorting.sort))}function w(t){if(0!==Object.getOwnPropertyNames(L.columns).length){var n=R(t),i="asc";n.hasClass("asc")&&(i="desc"),$(),n.addClass(i),L.options.sorting.sort=[t+" "+i],O()}}function $(){angular.forEach(Object.keys(L.columns),function(t){if(L.columns[t].field){var n=R(L.columns[t].field);n.removeClass("desc"),n.removeClass("asc")}})}function R(t){if(t){var n=a.tcOptions+"_"+t.replace(/\./g,"");return angular.element(document.getElementById(n))}}function E(t){-1==L.columns.indexOf(t)&&L.columns.push(t)}function I(){_()}function T(){console.log("test")}var z,D,k=!1,L=this;L.pageCount=1,L.showFooter=!1,L.columns=[],L.columnTemplates=a.colTemplates,L.headerTemplates=a.headerTemplates,L.rowTemplate=a.rowTemplate,L.addColumn=E,L.prev=G,L.next=S,L.first=b,L.last=P,L.sort=w,L.updatePageSize=I,L.orderColumns=l,r(),i.$on("$destroy",function(){z&&o.cancel(z),D&&o.cancel(D)}),this.test=T}],controllerAs:"tcGrid"}}function n(){return{restrict:"E",require:"^tcGrid",replace:!0,transclude:!0,template:"<div class='tc-display_td' ng-transclude></div>"}}angular.module("tc-grid",[]).directive("tcGrid",t).directive("tcColumn",n),t.$inject=["$parse","$compile","$templateCache","$timeout"]}(),angular.module("tc-grid").run(["$templateCache",function(t){t.put("tcGrid.html",'<div class="tcGrid__scope">\r\n    <div class="%GRIDCLASS%">\r\n        <div class="tc-display_table tc-style_table">\r\n            <div class="tc-display_thead tc-style_thead">\r\n                <div class="tc-display_tr tc-style_tr">\r\n                    %HEADER%\r\n                </div>\r\n            </div>\r\n            <div class="tc-display_tbody tc-style_tbody">\r\n                <div class="tc-display_tr %ROWCLASS%" ng-class="%ROWEXPRESSION%" id="tc-row-container" ng-repeat="row in tcGrid.data %FILTER%" %ROWCLICK%>\r\n                    %CHILDREN%\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <div class="tc-display_pager" ng-show="tcGrid.showFooter && tcGrid.pageCount > 1">\r\n            <div class="tc-display_item-total">\r\n                {{(tcGrid.options.paging.currentPage - 1) * tcGrid.options.paging.pageSize + 1}}\r\n                -\r\n                {{tcGrid.options.paging.currentPage === tcGrid.pageCount ? tcGrid.options.paging.totalItemCount : tcGrid.options.paging.currentPage * tcGrid.options.paging.pageSize}}\r\n                of\r\n                {{tcGrid.options.paging.totalItemCount}}\r\n            </div>\r\n            <div class="tc-display_page-nav">\r\n                <span class="tc-style_page-display">{{tcGrid.options.paging.currentPage}} / {{tcGrid.pageCount}}</span>\r\n                <select ng-if="tcGrid.options.paging.pageSizeOptions.length" ng-options="pageSize for pageSize in tcGrid.options.paging.pageSizeOptions" ng-model="tcGrid.options.paging.pageSize" ng-change="tcGrid.updatePageSize()"></select>\r\n                <button class="tc-button" ng-click="tcGrid.first()" ng-disabled="tcGrid.options.paging.currentPage === 1"><strong>|</strong>&#9668;</button>\r\n                <button class="tc-button" ng-click="tcGrid.prev()" ng-disabled="tcGrid.options.paging.currentPage === 1">&#9668;</button>\r\n                <button class="tc-button" ng-click="tcGrid.next()" ng-disabled="tcGrid.options.paging.currentPage === tcGrid.pageCount">&#9658;</button>\r\n                <button class="tc-button" ng-click="tcGrid.last()" ng-disabled="tcGrid.options.paging.currentPage === tcGrid.pageCount">&#9658;<strong>|</strong></button>\r\n            </div>\r\n            <div class="clearfix"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n')}]);