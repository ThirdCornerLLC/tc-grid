"use strict";!function(){function t(t,n,e,i){return{restrict:"E",scope:!0,priority:1,compile:function(t,n){var i=t.find("tc-column");n.defaultHeaders=[],angular.forEach(i,function(e,i){var o=e.getAttribute("tc-class");e.setAttribute("data-identifier",Math.random()),e.setAttribute("tc-col-index",i+1),e.className+=" "+(o||"tc-style_td"),n.defaultHeaders.push({element:t,options:{tcName:e.getAttribute("tc-name"),tcField:e.getAttribute("tc-field"),identifier:e.getAttribute("data-identifier")}})});var o=e.get("tcGrid.html");o=o.replace(/%GRIDCLASS%/g,n.tcGridClass||"tc-grid"),o=o.replace(/%ROWCLASS%/g,n.tcRowClass?"":"tc-style_tr"),o=o.replace(/%ROWEXPRESSION%/g,n.tcRowClass||""),o=o.replace(/%ROWCLICK%/g,n.tcRowClick?'ng-click="'+n.tcRowClick+'"':""),o=o.replace(/%ROWLINK%/g,n.tcRowLink?' ng-href="'+n.tcRowLink+'"':""),o=o.replace(/%FILTER%/g,n.tcGridFilter?" | filter: "+n.tcGridFilter:"");var a=angular.element(o),r=a[0].querySelector(".tc-display_tbody .tc-display_tr");return n.rowTemplate=angular.element(r),n.rowTemplate.append(i),r=null,t.html(""),t.append(a),a=null,{pre:function(){},post:function(){}}},controller:["$scope","$element","$attrs",function(e,o,a){function r(){E.options=t(a.tcOptions)(e.$parent),E.data=t(a.tcData)(e.$parent),c(),m(),v(),E.options&&(E.options.onLoad&&"function"==typeof E.options.onLoad?E.options.onLoad():E.options.sorting.onSortChange?O():E.options.paging.onPageChange&&_())}function s(){E.options.paging.currentPage=1,E.options.sorting.sort=[],R(),_(),O()}function c(){for(var t in a.defaultHeaders)l(a.defaultHeaders[t].element,a.defaultHeaders[t].options),a.defaultHeaders[t].element=null,a.defaultHeaders[t]=null}function l(t,n){if(!p(n)){var e,i,o;n.tcField=n.tcField||"",n.tcName=n.tcName||n.tcField;var r=E.headerTemplates.length;n.tcField?(e=" ng-click=\"tcGrid.sort('"+n.tcField+"')\"",i=' id="'+a.tcOptions+"_"+n.tcField.replace(/\./g,"")+'"'):(e="",i=""),o=" ng-class=\"{'tc-hide-col': !tcGrid.columns['"+r+"'].visible}\"";var s='<div class="tc-display_th tc-style_th" tc-col-index="'+(r+1)+'"'+i+e+o+">"+n.tcName+'<span class="tc-display_sort tc-style_sort"></span></div>',c=angular.element(s);E.headerTemplates.push(c),E.columnTemplates.push(t.clone()),t=null,c=null,z(n),g()}}function p(t){for(var n=0;n<E.columns.length;n++)if(E.columns[n].identifier===t.identifier)return!0;return!1}function g(t){if(!t)for(var t=[],n=0;n<E.columns.length;n++)t.push(n+1);if(E.columns.length){var e=f();u(e,t),e=null}}function u(t,i){var o=angular.element(t.thead),a=angular.element(o.find("div")[0]);a.html("");for(var r in i){var s=d(E.headerTemplates,i[r]);a.append(s.clone()),s=null}n(o)(e),a=null,o=null,h()}function d(t,n){for(var e in t){var i=t[e].attr("tc-col-index"),o=t[e].attr("tc-name"),a=t[e].attr("tc-field");if(i==n||o==n||a==n)return t[e]}}function f(){var t,n,e,i=document.getElementsByClassName("tc-display_table")[0],o=Array.prototype.slice.call(i.children);for(var a in o)e=o[a],e.className&&e.className.indexOf("tc-display_thead")>-1?t=e:e.className&&e.className.indexOf("tc-display_tbody")>-1&&(n=e,n.parent=e.parentNode);return i.tbody=n,i.thead=t,n=null,t=null,i}function m(){E.options&&(E.options.reset=s,E.options.prev=P,E.options.next=S,E.options.first=G,E.options.last=b,E.options.sort=w,E.options.paging?C():E.options.paging={},E.options.sorting?h():E.options.sorting={})}function v(){function t(){return L?void(E.options&&E.options.paging&&y()):void(L=!0)}a.tcOptions&&e.$parent.$watch(a.tcOptions,function(n,e){if(E.options=n,n==e&&n.columnDisplay)g(E.options.columnDisplay);else if(n!=e||n.columnDisplay)n.columnDisplay!=e.columnDisplay&&g(E.options.columnDisplay);else{for(var i=[],o=0;o<E.columns.length;o++)i.push(o+1);g(i)}t()},!0),e.$parent.$watchCollection(a.tcData,function(t){E.data=t})}function C(){(!E.options.paging.pageSize||E.options.paging.pageSize<1)&&(E.options.paging.pageSizeOptions?E.options.paging.pageSize=E.options.paging.pageSizeOptions[0]:E.options.paging.pageSize=20),(!E.options.paging.totalItemCount||E.options.paging.totalItemCount<0)&&(E.options.paging.totalItemCount=0),(!E.options.paging.currentPage||E.options.paging.currentPage<1)&&(E.options.paging.currentPage=1),y(),a.tcHideFooter||(E.showFooter=!0)}function h(){E.options.sorting.sort&&angular.forEach(E.options.sorting.sort,function(t){var n=t.split(" ")[0],e=t.split(" ")[1]||"asc",i=N(n);i&&(i.addClass(e.toLowerCase()),i=null)})}function y(){E.pageCount=E.options.paging.totalItemCount>0?Math.ceil(E.options.paging.totalItemCount/E.options.paging.pageSize):0,E.pageCount<1&&(E.pageCount=1),E.options.paging.pageCount=E.pageCount}function G(){E.options.paging.currentPage=1,_()}function P(){E.options.paging.currentPage-=1,E.options.paging.currentPage<1&&(E.options.paging.currentPage=1),_()}function S(){E.options.paging.currentPage+=1,E.options.paging.currentPage>E.pageCount&&(E.options.paging.currentPage=E.pageCount),_()}function b(){E.options.paging.currentPage=E.pageCount,_()}function _(){E.options.paging.onPageChange&&E.options.paging.onPageChange(E.options.paging.currentPage,E.options.paging.pageSize,E.options.sorting.sort)}function O(){E.options.sorting.onSortChange&&(E.options.paging?(E.options.paging.currentPage=1,E.options.sorting.onSortChange(E.options.paging.currentPage,E.options.paging.pageSize,E.options.sorting.sort)):E.options.sorting.onSortChange(null,null,E.options.sorting.sort))}function w(t){if(0!==Object.getOwnPropertyNames(E.columns).length){var n=N(t);if(n){var e="asc";n.hasClass("asc")&&(e="desc"),R(),n.addClass(e),E.options.sorting.sort=[t+" "+e],O(),n=null}}}function R(){angular.forEach(Object.keys(E.columns),function(t){if(E.columns[t].field){var n=N(E.columns[t].field);n&&(n.removeClass("desc"),n.removeClass("asc"),n=null)}})}function N(t){if(t){var n=a.tcOptions+"_"+t.replace(/\./g,""),e=document.getElementById(n);if(e){var i=e.childNodes;for(var o in i)if(i[o].className&&i[o].className.indexOf("tc-display_sort")>-1)return angular.element(i[o])}return null}}function z(t){E.columns.push({field:t.tcField,identifier:t.identifier,visible:!0})}function I(){y(),E.options.paging.currentPage>E.pageCount?E.options.paging.currentPage=E.pageCount:E.options.paging.currentPage<0&&(E.options.paging.currentPage=0),_()}var $,F,L=!1,E=this;E.pageCount=1,E.showFooter=!1,E.columns=[],E.columnTemplates=[],E.headerTemplates=[],E.rowTemplate=a.rowTemplate,a.rowTemplate=null,E.addColumn=z,E.prev=P,E.next=S,E.first=G,E.last=b,E.sort=w,E.updatePageSize=I,E.orderColumns=g,E.registerColumn=l,r(),e.$on("$destroy",function(){$&&i.cancel($),F&&i.cancel(F)})}],controllerAs:"tcGrid"}}function n(){return{restrict:"E",require:"^?tcGrid",replace:!0,transclude:!0,template:"<div class='tc-display_td' ng-transclude></div>",compile:function(t,n){return{pre:function(t,n,e,i){i&&i.registerColumn(n,e)}}}}}angular.module("tc-grid",[]).directive("tcGrid",t).directive("tcColumn",n),t.$inject=["$parse","$compile","$templateCache","$timeout"]}(),angular.module("tc-grid").run(["$templateCache",function(t){t.put("tcGrid.html",'<div class="tcGrid__scope">\r\n    <div class="%GRIDCLASS%">\r\n        <div class="tc-display_table tc-style_table">\r\n            <div class="tc-display_thead tc-style_thead">\r\n                <div class="tc-display_tr tc-style_tr"></div>\r\n            </div>\r\n            <div class="tc-display_tbody tc-style_tbody">\r\n                <a class="tc-display_tr %ROWCLASS%" ng-class="%ROWEXPRESSION%" id="tc-row-container" ng-repeat="row in tcGrid.data %FILTER%" %ROWCLICK% %ROWLINK%></a>\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <div class="tc-display_pager tc-style_pager" ng-show="tcGrid.showFooter && tcGrid.pageCount > 1">\r\n            <div class="tc-display_item-total">\r\n                {{(tcGrid.options.paging.currentPage - 1) * tcGrid.options.paging.pageSize + 1}}\r\n                -\r\n                {{tcGrid.options.paging.currentPage === tcGrid.pageCount ? tcGrid.options.paging.totalItemCount : tcGrid.options.paging.currentPage * tcGrid.options.paging.pageSize}}\r\n                of\r\n                {{tcGrid.options.paging.totalItemCount}}\r\n            </div>\r\n            <div class="tc-display_page-nav">\r\n                <span class="tc-style_page-display">{{tcGrid.options.paging.currentPage}} / {{tcGrid.pageCount}}</span>\r\n                <select class="tc-select" ng-if="tcGrid.options.paging.pageSizeOptions.length" ng-options="pageSize for pageSize in tcGrid.options.paging.pageSizeOptions" ng-model="tcGrid.options.paging.pageSize" ng-change="tcGrid.updatePageSize()"></select>\r\n                <button class="tc-button" ng-click="tcGrid.first()" ng-disabled="tcGrid.options.paging.currentPage === 1"><strong>|</strong>&#9668;</button>\r\n                <button class="tc-button" ng-click="tcGrid.prev()" ng-disabled="tcGrid.options.paging.currentPage === 1">&#9668;</button>\r\n                <button class="tc-button" ng-click="tcGrid.next()" ng-disabled="tcGrid.options.paging.currentPage === tcGrid.pageCount">&#9658;</button>\r\n                <button class="tc-button" ng-click="tcGrid.last()" ng-disabled="tcGrid.options.paging.currentPage === tcGrid.pageCount">&#9658;<strong>|</strong></button>\r\n            </div>\r\n            <div class="clearfix"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n')}]);